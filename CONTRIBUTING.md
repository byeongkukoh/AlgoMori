# Contributing / 협업 규칙

이 문서는 AlgoMori에서 **Commit / Merge / PR 규칙**을 표준화합니다.

- 브랜치 전략은 `BRANCHING.md`를 따릅니다.
- 기본 원칙: `main`은 릴리즈용, `dev`는 개발 최신입니다.

---

## 1) Commit 규칙

### 1.1 커밋 메시지 포맷

기본 포맷:

```
<type>: <subject>

<body>
```

- `type`은 아래 목록 중 하나를 사용합니다.
- `subject`는 한 줄 요약(가능하면 50자 내외)이며 **무엇을/왜를 간결하게** 씁니다.
- `body`는 선택이지만, **비트는 변경/의사결정이 포함된 변경이면 필수**로 작성합니다.

### 1.2 type 목록

`README.md`에 있는 규칙을 확장 없이 그대로 사용합니다.

- `feat:` 새로운 기능 추가
- `fix:` 버그 수정
- `docs:` 문서 수정
- `refactor:` 기능 변화 없는 구조 개선
- `test:` 테스트 코드 추가/수정

(필요하면 향후 `chore:`를 추가하는 것으로 합의할 수 있습니다.)

### 1.3 Subject 작성 규칙

- 현재형/명령형으로 씁니다.
  - 좋은 예: `fix: KST 스케줄 계산 오류 수정`
  - 피할 예: `fixed ...`, `fixing ...`
- 구현 디테일보다 사용자/동작 관점의 요약을 우선합니다.
- 이슈/PR 연동이 있다면 body에 링크/번호를 남깁니다.

### 1.4 Body 작성 규칙

**Body는 다음 중 하나라도 해당하면 필수입니다.**
- 동작 변경(behavior change)
- 버그 원인/재현/해결 방식 설명 필요
- 트레이드오프/대안 검토가 있었음
- 롤백/마이그레이션/운영 영향이 있음

권장 템플릿:

```
Why:
- 왜 이 변경이 필요한가

What:
- 핵심 변경 사항

How to test:
- 테스트 방법/커맨드

Refs:
- 관련 이슈/PR 링크
```

### 1.5 커밋 단위

- 한 커밋은 한 가지 목적을 갖도록 쪼갭니다.
- 불필요한 포매팅/리네이밍/리팩터링을 기능 변경 커밋에 섞지 않습니다.
- 비밀정보(`.env`, 토큰 등)는 절대 커밋하지 않습니다.

---

## 2) Merge 규칙

### 2.1 기본 원칙

- `dev`/`main` 직접 푸시는 금지(예외: 저장소 관리자 긴급 대응).
- 모든 변경은 PR을 통해 병합합니다.

### 2.2 병합 대상

- 일반 개발/문서 변경: 단기 브랜치 → `dev`
- 릴리즈: `dev` → `main`

### 2.3 병합 방식(권장)

- **단기 브랜치 → `dev`**: `Squash merge` 권장
  - `dev`를 "최신 개발 상태"로 유지하면서 커밋 노이즈를 줄이기 위함
- **`dev` → `main`(릴리즈 PR)**: `Merge commit` 권장
  - 릴리즈 단위를 하나의 PR/커밋으로 식별하기 위함

### 2.4 Merge 커밋 메시지 규칙

#### Squash merge 메시지
- 제목: PR 제목을 그대로 사용 (`type: subject`)
- 본문: PR 본문에서 **Summary/Testing/Refs** 정도를 남깁니다.

예시:
- 제목: `feat: 추천 명령 UI 개선`
- 본문:
  - Summary: ...
  - Testing: ...
  - Refs: #123

#### Release merge 메시지 (`dev` → `main`)
- 제목: `chore: release vX.Y.Z` 또는 `docs: release vX.Y.Z` 중 하나로 통일(팀 합의 필요)
- 본문: 해당 릴리즈에 포함된 변경 요약 + 태그/배포 체크리스트

> 릴리즈 태그(`vX.Y.Z`)는 merge 후 `main` 커밋에 붙입니다.

---

## 3) PR 규칙

### 3.1 PR 제목 규칙

PR 제목은 **Squash merge 시 최종 커밋 제목**이 되므로 커밋 규칙과 동일하게 씁니다.

- 포맷: `<type>: <subject>`
- 예: `fix: 자동 추천 스케줄 오류 수정`

### 3.2 PR 본문(Description) 필수 여부

**필수입니다.**

최소 포함 항목:
- Summary (무엇/왜)
- Testing (어떻게 검증했는지)
- Risk/Impact (영향/주의점)

### 3.3 PR 크기/구성

- 리뷰 가능한 크기(가능하면 한 PR에 한 목적).
- 기능 변경 PR에 무관한 리포맷/리네이밍을 섞지 않습니다.

### 3.4 Merge 조건(권장)

- 최소 1명 리뷰 승인(팀 규모에 따라 조정)
- 테스트/수동 검증 완료
- 충돌 해결 후 최신 `dev` 기준으로 유지

---

## 4) PR 템플릿(복사/붙여넣기)

아래 템플릿을 PR 본문에 그대로 복사해 사용합니다.

```
## Summary
- 

## Changes
- 

## Testing
- [ ] 로컬 실행: `python main.py`
- [ ] 스모크 테스트(필요 시):
  - 

## Risk / Impact
- 

## Rollback Plan
- 

## References
- Related issue:
- PR link(s):

## Checklist
- [ ] 단일 목적 PR이다
- [ ] 불필요한 변경(포매팅/리네이밍)이 없다
- [ ] 비밀정보가 포함되지 않았다
- [ ] 문서/CHANGELOG 업데이트가 필요하면 반영했다
```
